// SPDX-License-Identifier: AGPL-3.0-only
pragma solidity ^0.8.10;

import "ds-test/test.sol";

import "contracts/interfaces/IAloeBlend.sol";

import "contracts/AloeBlend.sol";
import "contracts/Factory.sol";

contract FactoryTest is DSTest {
    bytes constant CREATION_CODE =
        hex"6102006040523480156200001257600080fd5b5060405162005e2338038062005e238339810160408190526200003591620006a5565b82836001600160a01b0316630dfe16816040518163ffffffff1660e01b8152600401602060405180830381865afa15801562000075573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906200009b9190620006f9565b6001600160a01b03166395d89b416040518163ffffffff1660e01b8152600401600060405180830381865afa158015620000d9573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f1916820160405262000103919081019062000769565b846001600160a01b031663d21220a76040518163ffffffff1660e01b8152600401602060405180830381865afa15801562000142573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190620001689190620006f9565b6001600160a01b03166395d89b416040518163ffffffff1660e01b8152600401600060405180830381865afa158015620001a6573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f19168201604052620001d0919081019062000769565b604051602001620001e392919062000821565b604051602081830303815290604052806040518060400160405280600a815260200169105313d14b509311539160b21b8152506012826000908051906020019062000230929190620005e6565b50815162000246906001906020850190620005e6565b5060ff81166080524660a0526200025c620004e5565b60c052505050506001600160a01b03811660e081905260408051630dfe168160e01b81529051630dfe1681916004808201926020929091908290030181865afa158015620002ae573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190620002d49190620006f9565b6001600160a01b0316610100816001600160a01b031681525050806001600160a01b031663d21220a76040518163ffffffff1660e01b8152600401602060405180830381865afa1580156200032d573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190620003539190620006f9565b6001600160a01b0316610120816001600160a01b031681525050806001600160a01b031663d0c93a7c6040518163ffffffff1660e01b8152600401602060405180830381865afa158015620003ac573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190620003d2919062000878565b60020b6101408160020b8152505050620003ff620d89e719610140516200058160201b620020de1760201c565b60020b610160526200042e62000419620d89e7196200089d565b61014051620005b660201b6200210d1760201c565b60020b61018052604080516355b13a4f60e01b8152905133916355b13a4f9160048083019260209291908290030181865afa15801562000472573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190620004989190620006f9565b6001600160a01b039081166101a0529182166101c052166101e052506006805465ffffffffffff60601b19166c010000000000000000000000004265ffffffffffff1602179055620009de565b60007f8b73c3c69bb8fe3d512ecc4cf759cc79239f7b179b0ffacaa9a75d522b39400f60006040516200051991906200090a565b6040805191829003822060208301939093528101919091527fc89efdaa54c0f20c7adf612882df0950f5a951637e0307cdcb4c672f298b8bc660608201524660808201523060a082015260c00160405160208183030381529060405280519060200120905090565b600080620005908385620009ad565b905060008160020b1315620005ab57830382019050620005b0565b830390505b92915050565b600080620005c58385620009ad565b905060008160020b12620005dd5783039050620005b0565b90920303919050565b828054620005f490620008ce565b90600052602060002090601f01602090048101928262000618576000855562000663565b82601f106200063357805160ff191683800117855562000663565b8280016001018555821562000663579182015b828111156200066357825182559160200191906001019062000646565b506200067192915062000675565b5090565b5b8082111562000671576000815560010162000676565b6001600160a01b0381168114620006a257600080fd5b50565b600080600060608486031215620006bb57600080fd5b8351620006c8816200068c565b6020850151909350620006db816200068c565b6040850151909250620006ee816200068c565b809150509250925092565b6000602082840312156200070c57600080fd5b815162000719816200068c565b9392505050565b634e487b7160e01b600052604160045260246000fd5b60005b838110156200075357818101518382015260200162000739565b8381111562000763576000848401525b50505050565b6000602082840312156200077c57600080fd5b81516001600160401b03808211156200079457600080fd5b818401915084601f830112620007a957600080fd5b815181811115620007be57620007be62000720565b604051601f8201601f19908116603f01168101908382118183101715620007e957620007e962000720565b816040528281528760208487010111156200080357600080fd5b6200081683602083016020880162000736565b979650505050505050565b6a020b637b290213632b732160ad1b8152600083516200084981600b85016020880162000736565b602f60f81b600b9184019182015283516200086c81600c84016020880162000736565b01600c01949350505050565b6000602082840312156200088b57600080fd5b81518060020b81146200071957600080fd5b60008160020b627fffff198103620008c557634e487b7160e01b600052601160045260246000fd5b60000392915050565b600181811c90821680620008e357607f821691505b6020821081036200090457634e487b7160e01b600052602260045260246000fd5b50919050565b600080835481600182811c9150808316806200092757607f831692505b602080841082036200094757634e487b7160e01b86526022600452602486fd5b8180156200095e576001811462000970576200099f565b60ff198616895284890196506200099f565b60008a81526020902060005b86811015620009975781548b8201529085019083016200097c565b505084890196505b509498975050505050505050565b60008260020b80620009cf57634e487b7160e01b600052601260045260246000fd5b808360020b0791505092915050565b60805160a05160c05160e05161010051610120516101405161016051610180516101a0516101c0516101e05161526a62000bb96000396000818161092801528181610b9601528181611322015281816117840152818161194101528181611a10015281816125a40152818161298801528181612a310152818161303b015261340101526000818161058601528181610b64015281816112f00152818161175a015281816117e7015281816118c7015281816124b101528181612bc501528181612c6e01528181612fd701526133700152600081816104f40152612d7c015260008181612f480152612f7a015260008181612ef30152612f1e015260008181610c5301528181610c9801528181610cdf01528181610db101528181610df601528181610e3d01528181612e850152612ebe0152600081816105520152818161152b01528181611ca601528181611e51015281816128f4015261323f0152600081816104a8015281816114f601528181611c7201528181611e1701528181612b7801526131800152600081816106ab01528181610a99015281816113530152818161163401528181611dda01528181612227015281816122790152612d50015260006115f9015260006115c40152600061044a015261526a6000f3fe6080604052600436106102bf5760003560e01c8063819b71c81161016e578063c3bd5945116100cb578063d5ffb4e51161007f578063da3848db11610064578063da3848db1461080e578063dd62ed3e146108de578063e035814d1461091657600080fd5b8063d5ffb4e5146107cd578063d785598e146107f857600080fd5b8063d0c9bdb4116100b0578063d0c9bdb414610763578063d34879971461078d578063d505accf146107ad57600080fd5b8063c3bd594514610737578063c620033f1461074d57600080fd5b80639f13f76d11610122578063a9059cbb11610107578063a9059cbb14610702578063a932492f14610722578063ad1383f81461032657600080fd5b80639f13f76d146106cd578063a41fe49f146106e257600080fd5b806388a9f8bb1161015357806388a9f8bb1461066e57806395d89b41146106845780639b1475581461069957600080fd5b8063819b71c81461062f57806383db382d1461064557600080fd5b806332e7c5bf1161021c5780635ee04d78116101d057806370a08231116101b557806370a08231146105a85780637ecebe00146105d55780637f86d13c1461060257600080fd5b80635ee04d781461054057806362d7d45e1461057457600080fd5b8063443ec74d11610201578063443ec74d1461049657806355b13a4f146104e25780635d7f850c1461051657600080fd5b806332e7c5bf1461046c5780633644e5151461048157600080fd5b806321c28191116102735780632505c3d9116102585780632505c3d9146103c957806330adf81f14610404578063313ce5671461043857600080fd5b806321c281911461038757806323b872dd146103a957600080fd5b80630f529ba2116102a45780630f529ba2146103265780631304fd581461034d57806318160ddd1461037157600080fd5b806306fdde03146102cb578063095ea7b3146102f657600080fd5b366102c657005b600080fd5b3480156102d757600080fd5b506102e061094a565b6040516102ed9190614a02565b60405180910390f35b34801561030257600080fd5b50610316610311366004614a4d565b6109d8565b60405190151581526020016102ed565b34801561033257600080fd5b5061033b600a81565b60405160ff90911681526020016102ed565b34801561035957600080fd5b5061036360095481565b6040519081526020016102ed565b34801561037d57600080fd5b5061036360025481565b34801561039357600080fd5b506103a76103a2366004614a79565b610a45565b005b3480156103b557600080fd5b506103166103c4366004614a96565b61115d565b3480156103d557600080fd5b506103e96103e4366004614ad7565b611251565b604080519384526020840192909252908201526060016102ed565b34801561041057600080fd5b506103637f6e71edae12b1b97f4d1f60370fef10105fa2faae0126114a169c64845d6126c981565b34801561044457600080fd5b5061033b7f000000000000000000000000000000000000000000000000000000000000000081565b34801561047857600080fd5b5061033b600281565b34801561048d57600080fd5b506103636115c0565b3480156104a257600080fd5b506104ca7f000000000000000000000000000000000000000000000000000000000000000081565b6040516001600160a01b0390911681526020016102ed565b3480156104ee57600080fd5b506104ca7f000000000000000000000000000000000000000000000000000000000000000081565b34801561052257600080fd5b5061052b61161b565b604080519283526020830191909152016102ed565b34801561054c57600080fd5b506104ca7f000000000000000000000000000000000000000000000000000000000000000081565b34801561058057600080fd5b506104ca7f000000000000000000000000000000000000000000000000000000000000000081565b3480156105b457600080fd5b506103636105c3366004614a79565b60036020526000908152604090205481565b3480156105e157600080fd5b506103636105f0366004614a79565b60056020526000908152604090205481565b34801561060e57600080fd5b5061036361061d366004614a79565b600b6020526000908152604090205481565b34801561063b57600080fd5b5061036360085481565b34801561065157600080fd5b5061065b61019281565b60405160029190910b81526020016102ed565b34801561067a57600080fd5b506103636101f481565b34801561069057600080fd5b506102e06116d6565b3480156106a557600080fd5b506104ca7f000000000000000000000000000000000000000000000000000000000000000081565b3480156106d957600080fd5b5061033b600481565b3480156106ee57600080fd5b5061052b6106fd366004614b09565b6116e3565b34801561070e57600080fd5b5061031661071d366004614a4d565b611d39565b34801561072e57600080fd5b5061033b601481565b34801561074357600080fd5b50610363600a5481565b34801561075957600080fd5b5061065b616c5081565b34801561076f57600080fd5b50610778611db1565b60405163ffffffff90911681526020016102ed565b34801561079957600080fd5b506103a76107a8366004614b35565b611dcf565b3480156107b957600080fd5b506103a76107c8366004614bc4565b611e7e565b3480156107d957600080fd5b506107e46201518081565b60405162ffffff90911681526020016102ed565b34801561080457600080fd5b5061036360075481565b34801561081a57600080fd5b5060065461088590600281810b9163010000008104820b9166010000000000008204810b916901000000000000000000810490910b9065ffffffffffff600160601b8204169063ffffffff600160901b8204169060ff600160b01b8204811691600160b81b90041688565b604080516002998a0b815297890b602089015295880b958701959095529290950b606085015265ffffffffffff16608084015263ffffffff90931660a083015291151560c082015290151560e0820152610100016102ed565b3480156108ea57600080fd5b506103636108f9366004614c35565b600460209081526000928352604080842090915290825290205481565b34801561092257600080fd5b506104ca7f000000000000000000000000000000000000000000000000000000000000000081565b6000805461095790614c6e565b80601f016020809104026020016040519081016040528092919081815260200182805461098390614c6e565b80156109d05780601f106109a5576101008083540402835291602001916109d0565b820191906000526020600020905b8154815290600101906020018083116109b357829003601f168201915b505050505081565b3360008181526004602090815260408083206001600160a01b038716808552925280832085905551919290917f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b92590610a339086815260200190565b60405180910390a35060015b92915050565b60005a90506000806000806000610a5a612139565b6006805460ff60b81b1916600160b81b1790556040805160608101825260008082526020820181905291810191909152949950929750909550935091507f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316633850c7bd6040518163ffffffff1660e01b815260040160e060405180830381865afa158015610af5573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610b199190614cca565b5050505060029190910b6040840152506001600160a01b0316808252610b449080600160601b6122df565b6001600160e01b031660208201526000610b5d8561238e565b9050610b917f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03166123b2565b610bc37f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03166123b2565b6000806000610bd98a8a876000015160006123f3565b92509250925080606001516001600160801b0316600014610c09576060810151610c04908a90612764565b505050505b6000610c3d61271085610c2e86600160601b8b602001516001600160e01b03166122df565b610c389088614d74565b6122df565b9050611324811015610d9d57610c7786604001517f000000000000000000000000000000000000000000000000000000000000000061210d565b60020b60408b015260608201516001600160801b031615801590610cd357507f00000000000000000000000000000000000000000000000000000000000000008a60400151610cc69190614d8c565b60020b8a6020015160020b145b15610cdd57600094505b7f00000000000000000000000000000000000000000000000000000000000000008a60400151610d0d9190614d8c565b60020b6020808c0191909152860151600090600190610d3b9087906001600160e01b0316600160601b6122df565b610d459086614dd4565b901c90508260200151811115610d5c575060208201515b6000610d666128d0565b905081811015610d8057610d7b81830361296a565b810191505b50610d95610d8e8c83612a6c565b8c90612a91565b505050610f1c565b6113ec811115610ee557610dd586604001517f00000000000000000000000000000000000000000000000000000000000000006120de565b60020b60208b015260608201516001600160801b031615801590610e3157507f00000000000000000000000000000000000000000000000000000000000000008a60200151610e249190614deb565b60020b8a6040015160020b145b15610e3b57600094505b7f00000000000000000000000000000000000000000000000000000000000000008a60200151610e6b9190614deb565b60020b60408b01526020860151600090600190610e98908690600160601b906001600160e01b03166122df565b610ea29087614dd4565b8451911c9150811115610eb3575081515b6000610ebd612b54565b905081811015610ed757610ed2818303612ba7565b810191505b50610d95610d8e8c83612ca9565b60408051606081018252600080825260208201819052918101919091529950610f16868c846040015187878c612cce565b9a504298505b5a610f298d615208614e32565b63ffffffff16610f399190614dd4565b9b508763ffffffff168c63ffffffff161115610f53578b97505b610f608d868e8b8b6130e2565b6002546040805184815260208101929092528101869052606081018590529097507f802a0d65ee1ffb3e6af96deafe1fc3e6402b2672a2f4b79d1b23c4a06c998f349060800160405180910390a16040518061010001604052808c6020015160020b81526020018c6040015160020b81526020018b6020015160020b81526020018b6040015160020b81526020018a65ffffffffffff1681526020018963ffffffff168152602001881515815260200160001515815250600660008201518160000160006101000a81548162ffffff021916908360020b62ffffff16021790555060208201518160000160036101000a81548162ffffff021916908360020b62ffffff16021790555060408201518160000160066101000a81548162ffffff021916908360020b62ffffff16021790555060608201518160000160096101000a81548162ffffff021916908360020b62ffffff160217905550608082015181600001600c6101000a81548165ffffffffffff021916908365ffffffffffff16021790555060a08201518160000160126101000a81548163ffffffff021916908363ffffffff16021790555060c08201518160000160166101000a81548160ff02191690831515021790555060e08201518160000160176101000a81548160ff02191690831515021790555090505050505050505050505050505050565b6001600160a01b038316600090815260046020908152604080832033845290915281205460001981146111b9576111948382614dd4565b6001600160a01b03861660009081526004602090815260408083203384529091529020555b6001600160a01b038516600090815260036020526040812080548592906111e1908490614dd4565b90915550506001600160a01b03808516600081815260036020526040908190208054870190555190918716907fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef9061123c9087815260200190565b60405180910390a360019150505b9392505050565b600080808615158061126257508515155b6112b35760405162461bcd60e51b815260206004820152600f60248201527f416c6f653a2030206465706f736974000000000000000000000000000000000060448201526064015b60405180910390fd5b6000806112be612139565b50506006805460ff60b81b1916600160b81b1790555090925090506112e282613504565b6112eb81613504565b61131d7f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03166123b2565b61134f7f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03166123b2565b60007f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316633850c7bd6040518163ffffffff1660e01b815260040160e060405180830381865afa1580156113af573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906113d39190614cca565b50505050505090506000806113eb85858560016123f3565b509150915061140060025483838f8f886135c6565b9199509750955060008890036114495760405162461bcd60e51b815260206004820152600e60248201526d416c6f653a20302073686172657360901b60448201526064016112aa565b898710156114995760405162461bcd60e51b815260206004820152601560248201527f416c6f653a20616d6f756e743020746f6f206c6f77000000000000000000000060448201526064016112aa565b888610156114e95760405162461bcd60e51b815260206004820152601560248201527f416c6f653a20616d6f756e743120746f6f206c6f77000000000000000000000060448201526064016112aa565b61151e6001600160a01b037f00000000000000000000000000000000000000000000000000000000000000001633308a613715565b6115536001600160a01b037f000000000000000000000000000000000000000000000000000000000000000016333089613715565b61155d3389613798565b604080518981526020810189905290810187905233907f36af321ec8d3c75236829c5317affd40ddb308863a1236d2d277a4025cccee1e9060600160405180910390a250506006805460ff60b81b19169055509398929750909550909350505050565b60007f000000000000000000000000000000000000000000000000000000000000000046146115f6576115f1613804565b905090565b507f000000000000000000000000000000000000000000000000000000000000000090565b600080600080611629612139565b5050509150915060007f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316633850c7bd6040518163ffffffff1660e01b815260040160e060405180830381865afa158015611690573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906116b49190614cca565b50505050505090506116c983838360006123f3565b5090969095509350505050565b6001805461095790614c6e565b600080846000036117275760405162461bcd60e51b815260206004820152600e60248201526d416c6f653a20302073686172657360901b60448201526064016112aa565b600080611732612139565b50506006805460ff60b81b1916600160b81b17905550909250905061177f6001600160a01b037f0000000000000000000000000000000000000000000000000000000000000000166123b2565b6117b17f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03166123b2565b60025460008080806117c1612b54565b6007546040516370a0823160e01b81523060048201529095509092506001600160a01b037f000000000000000000000000000000000000000000000000000000000000000016906370a0823190602401602060405180830381865afa15801561182e573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906118529190614e5a565b9250838311611862576000611878565b600a61186e8585614dd4565b6118789190614e89565b9350611899846118888585614d74565b6118929190614dd4565b8d876122df565b98508189111561191357816118ae8a86614d74565b6118b89190614dd4565b91506118ed6001600160a01b037f0000000000000000000000000000000000000000000000000000000000000000168361389e565b83600960008282546118ff9190614d74565b9091555061190f90508284614dd4565b6007555b61191b6128d0565b6008546040516370a0823160e01b81523060048201529095509092506001600160a01b037f000000000000000000000000000000000000000000000000000000000000000016906370a0823190602401602060405180830381865afa158015611988573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906119ac9190614e5a565b92508383116119bc5760006119d2565b600a6119c88585614dd4565b6119d29190614e89565b93506119e2846118888585614d74565b975081881115611a5c57816119f78986614d74565b611a019190614dd4565b9150611a366001600160a01b037f0000000000000000000000000000000000000000000000000000000000000000168361389e565b83600a6000828254611a489190614d74565b90915550611a5890508284614dd4565b6008555b6000611a6788613918565b505050509050611a8b611a84826001600160801b03168f896122df565b8990612764565b92975090955093509150611a9f858b614d74565b9950611aab848a614d74565b9850611ab8600a84614e89565b9450611ac5600a83614e89565b9350611adb611ad48685614dd4565b8e886122df565b611ae5908b614d74565b9950611af4611ad48584614dd4565b611afe908a614d74565b98508460096000828254611b129190614d74565b9250508190555083600a6000828254611b2b9190614d74565b9250508190555050856040015160020b866020015160020b14611bc5576000611b5387613918565b505050509050611b77611b70826001600160801b03168f896122df565b8890612764565b92975090955093509150611b8c838e886122df565b611b969086614d74565b611ba0908b614d74565b9950611bad828e886122df565b611bb79085614d74565b611bc1908a614d74565b9850505b8a891015611c155760405162461bcd60e51b815260206004820152601560248201527f416c6f653a20616d6f756e743020746f6f206c6f77000000000000000000000060448201526064016112aa565b89881015611c655760405162461bcd60e51b815260206004820152601560248201527f416c6f653a20616d6f756e743120746f6f206c6f77000000000000000000000060448201526064016112aa565b611c996001600160a01b037f000000000000000000000000000000000000000000000000000000000000000016338b613a00565b611ccd6001600160a01b037f000000000000000000000000000000000000000000000000000000000000000016338a613a00565b611cd7338d613a30565b604080518d8152602081018b905290810189905233907f02f25270a4d87bea75db541cdfe559334a275b4a233520ed6c0a2429667cca949060600160405180910390a250506006805460ff60b81b191690555094989397509295505050505050565b33600090815260036020526040812080548391908390611d5a908490614dd4565b90915550506001600160a01b038316600081815260036020526040908190208054850190555133907fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef90610a339086815260200190565b6006546000906115f190600160601b900465ffffffffffff1661238e565b336001600160a01b037f00000000000000000000000000000000000000000000000000000000000000001614611e0457600080fd5b8315611e3e57611e3e6001600160a01b037f0000000000000000000000000000000000000000000000000000000000000000163386613a00565b8215611e7857611e786001600160a01b037f0000000000000000000000000000000000000000000000000000000000000000163385613a00565b50505050565b42841015611ece5760405162461bcd60e51b815260206004820152601760248201527f5045524d49545f444541444c494e455f4558504952454400000000000000000060448201526064016112aa565b6000611ed86115c0565b6001600160a01b0389811660008181526005602090815260409182902080546001810190915582517f6e71edae12b1b97f4d1f60370fef10105fa2faae0126114a169c64845d6126c98184015280840194909452938c166060840152608083018b905260a083019390935260c08083018a90528151808403909101815260e08301909152805192019190912061190160f01b6101008301526101028201929092526101228101919091526101420160408051601f198184030181528282528051602091820120600080855291840180845281905260ff88169284019290925260608301869052608083018590529092509060019060a0016020604051602081039080840390855afa158015611ff1573d6000803e3d6000fd5b5050604051601f1901519150506001600160a01b038116158015906120275750886001600160a01b0316816001600160a01b0316145b6120735760405162461bcd60e51b815260206004820152600e60248201527f494e56414c49445f5349474e455200000000000000000000000000000000000060448201526064016112aa565b6001600160a01b0390811660009081526004602090815260408083208b8516808552908352928190208a905551898152919350918a16917f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925910160405180910390a350505050505050565b6000806120eb8385614e9d565b905060008160020b131561210457830382019050610a3f565b90920392915050565b60008061211a8385614e9d565b905060008160020b126121305783039050610a3f565b90920303919050565b604080516060810182526000808252602082018190529181019190915260408051606081018252600080825260208201819052918101919091526040805161010081018252600654600281810b835263010000008204810b602084015266010000000000008204810b938301939093526901000000000000000000810490920b606082015265ffffffffffff600160601b830416608082015263ffffffff600160901b83041660a082015260ff600160b01b83048116151560c0830152600160b81b90920490911615801560e0830152600091829182919061221a57600080fd5b60405180606001604052807f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03168152602001826000015160020b8152602001826020015160020b81525060405180606001604052807f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03168152602001836040015160020b8152602001836060015160020b81525082608001518360a001518460c0015195509550955095509550509091929394565b6000816000036122ee57600080fd5b600080600019858709858702925082811083820303915050806000036123195750829004905061124a565b83811061232557600080fd5b60008486880960026001871981018816978890046003810283188082028403028082028403028082028403028082028403028082028403029081029092039091026000889003889004909101858311909403939093029303949094049190911702949350505050565b6000610a3f620186a06123a965ffffffffffff851642614dd4565b620151806122df565b6040805160048152602481019091526020810180516001600160e01b0316630302f06b60e31b1790526123ef906001600160a01b03831690613aa4565b5050565b60408051608081018252600080825260208201819052918101829052606081018290528190600080876040015160020b886020015160020b146124965761243988613918565b6001600160801b039485166060890181905291851696509093169350612464928b92508a9150613ac9565b60208501528084528290849061247b908390614d74565b905250602083018051829190612492908390614d74565b9052505b6007546040516370a0823160e01b81523060048201529092507f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316906370a0823190602401602060405180830381865afa158015612500573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906125249190614e5a565b905081811161253457600061254a565b600a6125408383614dd4565b61254a9190614e89565b915085612557578161255a565b60005b81612563612b54565b61256d9190614d74565b6125779190614dd4565b83518490612586908390614d74565b9052506008546040516370a0823160e01b81523060048201529092507f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316906370a0823190602401602060405180830381865afa1580156125f3573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906126179190614e5a565b905081811161262757600061263d565b600a6126338383614dd4565b61263d9190614e89565b91508561264a578161264d565b60005b816126566128d0565b6126609190614d74565b61266a9190614dd4565b8360200181815161267b9190614d74565b905250604089015160208a0151600291820b910b1461274b5761269d89613918565b6001600160801b0394851660408901819052918516965090931693506126c8928c92508a9150613ac9565b9095509350856126e2576126dd600a83614e89565b6126e5565b60005b83516126f2908490614d74565b6126fc9190614dd4565b6127069086614d74565b94508561271d57612718600a82614e89565b612720565b60005b8184602001516127309190614d74565b61273a9190614dd4565b6127449085614d74565b9350612758565b8251602084015190955093505b50509450945094915050565b60008080806001600160801b0385161561280e5785516020870151604080890151905163a34123a760e01b8152600292830b6004820152910b60248201526001600160801b03871660448201526001600160a01b039091169063a34123a79060640160408051808303816000875af11580156127e4573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906128089190614ebf565b90945092505b8551602087015160408089015190516309e3d67b60e31b8152306004820152600292830b6024820152910b60448201526001600160801b0360648201819052608482015260009182916001600160a01b0390911690634f1eb3d89060a40160408051808303816000875af115801561288a573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906128ae9190614efa565b96999598506001600160801b039081168a900397509095168790039450505050565b600a546040516370a0823160e01b8152306004820152600091906001600160a01b037f000000000000000000000000000000000000000000000000000000000000000016906370a08231906024015b602060405180830381865afa15801561293c573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906129609190614e5a565b6115f19190614dd4565b6008546040516370a0823160e01b81523060048201526000919082907f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316906370a0823190602401602060405180830381865afa1580156129d7573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906129fb9190614e5a565b9050818111612a0b576000612a12565b600a828203045b9150818103841115612a245781810393505b612a596001600160a01b037f00000000000000000000000000000000000000000000000000000000000000001683860161389e565b600a805483019055038290036008555090565b600061124a612a7e8460200151613afc565b612a8b8560400151613afc565b84613e52565b6000806001600160801b03831615612b4d57835160208501516040808701519051633c8a7d8d60e01b8152306004820152600292830b6024820152910b60448201526001600160801b038516606482015260a06084820152600060a48201526001600160a01b0390911690633c8a7d8d9060c40160408051808303816000875af1158015612b23573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190612b479190614ebf565b90925090505b9250929050565b6009546040516370a0823160e01b8152306004820152600091906001600160a01b037f000000000000000000000000000000000000000000000000000000000000000016906370a082319060240161291f565b6007546040516370a0823160e01b81523060048201526000919082907f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316906370a0823190602401602060405180830381865afa158015612c14573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190612c389190614e5a565b9050818111612c48576000612c4f565b600a828203045b9150818103841115612c615781810393505b612c966001600160a01b037f00000000000000000000000000000000000000000000000000000000000000001683860161389e565b6009805483019055038290036007555090565b600061124a612cbb8460200151613afc565b612cc88560400151613afc565b84613ea3565b604080516060810182526000808252602082018190529181018290529080612cf68888612764565b935093505050600a60ff168281612d0f57612d0f614e73565b60098054929091049091019055600a805491819004909101905550600082612d3957616c50612df0565b60405163b168197d60e01b81526001600160a01b037f000000000000000000000000000000000000000000000000000000000000000081166004830152612df0917f00000000000000000000000000000000000000000000000000000000000000009091169063b168197d906024016020604051808303816000875af1158015612dc7573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190612deb9190614e5a565b613efa565b60020b60011d9050600080612e06878785613f74565b91509150600080612e1c896101f46127106122df565b612e24612b54565b039150612e36886101f46127106122df565b612e3e6128d0565b03905083821215612e5d5760009850612e58828503612ba7565b820193505b82811215612e795760009750612e7481840361296a565b810192505b612ea9858d60400151037f000000000000000000000000000000000000000000000000000000000000000061210d565b60020b60208c015260408c0151612ee29086017f00000000000000000000000000000000000000000000000000000000000000006120de565b600290810b60408d015260208c01517f0000000000000000000000000000000000000000000000000000000000000000820b910b1215612f46577f000000000000000000000000000000000000000000000000000000000000000060020b60208c01525b7f000000000000000000000000000000000000000000000000000000000000000060020b8b6040015160020b1315612fa2577f000000000000000000000000000000000000000000000000000000000000000060020b60408c01525b8b51612fb590610d8e908d908787613fe9565b9094509250881561301e57612ffd612fcd8584614dd4565b6001600160a01b037f00000000000000000000000000000000000000000000000000000000000000001690614010565b6130078483614dd4565b600760008282546130189190614d74565b90915550505b8715613082576130616130318483614dd4565b6001600160a01b037f00000000000000000000000000000000000000000000000000000000000000001690614010565b61306b8382614dd4565b6008600082825461307c9190614d74565b90915550505b7fe73e1a034909b10f2cbe101ce0618d683b1485c1c2da61474bdbebce08bcaf1a8b602001518c604001516040516130ca929190600292830b8152910b602082015260400190565b60405180910390a150989a9950505050505050505050565b60006001600160a01b03861661313e57604080516000808252602082015263ffffffff87168183015290517faf945aff5cea2d4d4f891882674c81bcdaeb15609c6d7bc80875dbc4ee83e4ee9181900360600190a150806134fb565b6001600160a01b0386166000908152600b60205260408120549061317c61316b63ffffffff881684614f2d565b8863ffffffff16633b9aca006122df565b90507f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316886001600160a01b03160361323d57600954808211806131c6575082155b156131cf578091505b6131d98282614dd4565b905060006131fa6131eb601486614f2d565b8863ffffffff166127106122df565b9050808211613209578161320b565b805b6009558082111561321f5760019550613236565b61322a600482614e89565b82101561323657600095505b5050613477565b7f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316886001600160a01b0316036132cf57600a5480821180613285575082155b1561328e578091505b6132988282614dd4565b905060006132aa6131eb601486614f2d565b90508082116132b957816132bb565b805b600a558082111561321f5760019550613236565b6040516370a0823160e01b81523060048201526000906001600160a01b038a16906370a0823190602401602060405180830381865afa158015613316573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061333a9190614e5a565b905080821180613348575082155b15613351578091505b60405163026c7dfb60e31b81526001600160a01b038a811660048301527f00000000000000000000000000000000000000000000000000000000000000001690631363efd890602401602060405180830381865afa1580156133b7573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906133db9190614f4c565b801561346c575060405163026c7dfb60e31b81526001600160a01b038a811660048301527f00000000000000000000000000000000000000000000000000000000000000001690631363efd890602401602060405180830381865afa158015613448573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061346c9190614f4c565b61347557600080fd5b505b61348b6001600160a01b0389163383613a00565b6134a7886134a2612710848a63ffffffff166122df565b61402f565b604080516001600160a01b038a1681526020810183905263ffffffff89168183015290517faf945aff5cea2d4d4f891882674c81bcdaeb15609c6d7bc80875dbc4ee83e4ee9181900360600190a183925050505b95945050505050565b806040015160020b816020015160020b0361351c5750565b600061352782613918565b505050509050806001600160801b03166000146123ef5781516020830151604080850151905163a34123a760e01b8152600292830b6004820152910b6024820152600060448201526001600160a01b039091169063a34123a79060640160408051808303816000875af11580156135a2573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190611e789190614ebf565b600080808815806135d657508715155b806135e057508615155b6135ec576135ec614f67565b8860000361366457600061360e6001600160a01b03861680600160601b6122df565b905061362886600160601b836001600160e01b03166122df565b92508683101561363d5785915081935061365e565b86925061365883826001600160e01b0316600160601b6122df565b91508293505b50613709565b87600003613680575083613679818a896122df565b9250613709565b8660000361369657859150613679828a8a6122df565b60008789106136b1576136aa87898b6122df565b86106136bf565b866136bd878b8b6122df565b105b905080156136e9578591506136d5828a8a6122df565b92506136e2828b8a6122df565b9350613707565b8692506136f783898b6122df565b9150613704838b8b6122df565b93505b505b96509650969350505050565b6040516001600160a01b0380851660248301528316604482015260648101829052611e789085906323b872dd60e01b906084015b60408051601f198184030181529190526020810180516001600160e01b03167fffffffff0000000000000000000000000000000000000000000000000000000090931692909217909152614103565b80600260008282546137aa9190614d74565b90915550506001600160a01b0382166000818152600360209081526040808320805486019055518481527fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef91015b60405180910390a35050565b60007f8b73c3c69bb8fe3d512ecc4cf759cc79239f7b179b0ffacaa9a75d522b39400f60006040516138369190614f7d565b6040805191829003822060208301939093528101919091527fc89efdaa54c0f20c7adf612882df0950f5a951637e0307cdcb4c672f298b8bc660608201524660808201523060a082015260c00160405160208183030381529060405280519060200120905090565b6040516024810182905261391390632e1a7d4d60e01b906044015b60408051601f198184030181529190526020810180516001600160e01b03167fffffffff00000000000000000000000000000000000000000000000000000000909316929092179091526001600160a01b03841690613aa4565b505050565b600080600080600085600001516001600160a01b031663514ea4bf30886020015189604001516040516020016139799392919060609390931b6bffffffffffffffffffffffff1916835260e891821b6014840152901b6017820152601a0190565b604051602081830303815290604052805190602001206040518263ffffffff1660e01b81526004016139ad91815260200190565b60a060405180830381865afa1580156139ca573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906139ee9190615018565b939a9299509097509550909350915050565b6040516001600160a01b03831660248201526044810182905261391390849063a9059cbb60e01b90606401613749565b6001600160a01b03821660009081526003602052604081208054839290613a58908490614dd4565b90915550506002805482900390556040518181526000906001600160a01b038416907fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef906020016137f8565b606061124a838360405180606001604052806027815260200161520e602791396141e8565b600080613af084613add8760200151613afc565b613aea8860400151613afc565b866142d3565b91509150935093915050565b60008060008360020b12613b13578260020b613b20565b8260020b613b209061506f565b9050613b2f620d89e71961508b565b62ffffff16811115613b675760405162461bcd60e51b81526020600482015260016024820152601560fa1b60448201526064016112aa565b600081600116600003613b8b57700100000000000000000000000000000000613b9d565b6ffffcb933bd6fad37aa2d162d1a5940015b70ffffffffffffffffffffffffffffffffff1690506002821615613bd1576ffff97272373d413259a46990580e213a0260801c5b6004821615613bf0576ffff2e50f5f656932ef12357cf3c7fdcc0260801c5b6008821615613c0f576fffe5caca7e10e4e61c3624eaa0941cd00260801c5b6010821615613c2e576fffcb9843d60f6159c9db58835c9266440260801c5b6020821615613c4d576fff973b41fa98c081472e6896dfb254c00260801c5b6040821615613c6c576fff2ea16466c96a3843ec78b326b528610260801c5b6080821615613c8b576ffe5dee046a99a2a811c461f1969c30530260801c5b610100821615613cab576ffcbe86c7900a88aedcffc83b479aa3a40260801c5b610200821615613ccb576ff987a7253ac413176f2b074cf7815e540260801c5b610400821615613ceb576ff3392b0822b70005940c7a398e4b70f30260801c5b610800821615613d0b576fe7159475a2c29b7443b29c7fa6e889d90260801c5b611000821615613d2b576fd097f3bdfd2022b8845ad8f792aa58250260801c5b612000821615613d4b576fa9f746462d870fdf8a65dc1f90e061e50260801c5b614000821615613d6b576f70d869a156d2a1b890bb3df62baf32f70260801c5b618000821615613d8b576f31be135f97d08fd981231505542fcfa60260801c5b62010000821615613dac576f09aa508b5b7a84e1c677de54f3e99bc90260801c5b62020000821615613dcc576e5d6af8dedb81196699c329225ee6040260801c5b62040000821615613deb576d2216e584f5fa1ea926041bedfe980260801c5b62080000821615613e08576b048a170391f7dc42444e8fa20260801c5b60008460020b1315613e29578060001981613e2557613e25614e73565b0490505b640100000000810615613e3d576001613e40565b60005b60ff16602082901c0192505050919050565b6000826001600160a01b0316846001600160a01b03161115613e72579192915b613e9b613e9683600160601b613e8888886150ad565b6001600160a01b03166122df565b61436f565b949350505050565b6000826001600160a01b0316846001600160a01b03161115613ec3579192915b6000613ee6856001600160a01b0316856001600160a01b0316600160601b6122df565b90506134fb613e968483613e8889896150ad565b6000662358b99a116be08211613f135750610192919050565b67053448a4815102008210613f2b5750616c50919050565b613f36600283614f2d565b91506000670de0b6b3a7640000839003730de0b6b3a764000000000000000000000000000081613f6857613f68614e73565b04905061124a8161438a565b60008080613f89613f848561508b565b613afc565b613fa0906001600160a01b0316600160601b614dd4565b9050613fbf86826bffffffffffffffffffffffff16600160601b6122df565b9250613fde85826bffffffffffffffffffffffff16600160601b6122df565b915050935093915050565b60006134fb84613ffc8760200151613afc565b6140098860400151613afc565b86866146d1565b604051602481018290526139139063b6b55f2560e01b906044016138b9565b6001600160a01b0382166000908152600c60209081526040808320600d835281842054600b90935292205460ff90911690600a8104810380851015614072578094505b600e85049450838360ff16600e811061408d5761408d6150d5565b01546001600160a01b0387166000908152600b60205260409020838701919091039055848460ff8516600e81106140c6576140c66150d5565b0155600e60ff60018501166001600160a01b03979097166000908152600d60205260409020805460ff19169190970660ff16179095555050505050565b6000614158826040518060400160405280602081526020017f5361666545524332303a206c6f772d6c6576656c2063616c6c206661696c6564815250856001600160a01b03166147899092919063ffffffff16565b80519091501561391357808060200190518101906141769190614f4c565b6139135760405162461bcd60e51b815260206004820152602a60248201527f5361666545524332303a204552433230206f7065726174696f6e20646964206e60448201527f6f7420737563636565640000000000000000000000000000000000000000000060648201526084016112aa565b6060833b61425e5760405162461bcd60e51b815260206004820152602660248201527f416464726573733a2064656c65676174652063616c6c20746f206e6f6e2d636f60448201527f6e7472616374000000000000000000000000000000000000000000000000000060648201526084016112aa565b600080856001600160a01b03168560405161427991906150eb565b600060405180830381855af49150503d80600081146142b4576040519150601f19603f3d011682016040523d82523d6000602084013e6142b9565b606091505b50915091506142c9828286614798565b9695505050505050565b600080836001600160a01b0316856001600160a01b031611156142f4579293925b846001600160a01b0316866001600160a01b03161161431f576143188585856147d1565b9150614366565b836001600160a01b0316866001600160a01b03161015614358576143448685856147d1565b915061435185878561484d565b9050614366565b61436385858561484d565b90505b94509492505050565b806001600160801b038116811461438557600080fd5b919050565b60006401000276a36001600160a01b038316108015906143c6575073fffd8963efd1fc6a506488495d951d5263988d266001600160a01b038316105b6143f65760405162461bcd60e51b81526020600482015260016024820152602960f91b60448201526064016112aa565b77ffffffffffffffffffffffffffffffffffffffff00000000602083901b166001600160801b03811160071b81811c67ffffffffffffffff811160061b90811c63ffffffff811160051b90811c61ffff811160041b90811c60ff8111600390811b91821c600f811160021b90811c918211600190811b92831c9790881196179094179092171790911717176080811061449e57614494607f82614dd4565b83901c91506144af565b6144a981607f614dd4565b83901b91505b600060406144be608084615107565b901b9050828302607f1c92508260801c80603f1b8217915083811c935050828302607f1c92508260801c80603e1b8217915083811c935050828302607f1c92508260801c80603d1b8217915083811c935050828302607f1c92508260801c80603c1b8217915083811c935050828302607f1c92508260801c80603b1b8217915083811c935050828302607f1c92508260801c80603a1b8217915083811c935050828302607f1c92508260801c8060391b8217915083811c935050828302607f1c92508260801c8060381b8217915083811c935050828302607f1c92508260801c8060371b8217915083811c935050828302607f1c92508260801c8060361b8217915083811c935050828302607f1c92508260801c8060351b8217915083811c935050828302607f1c92508260801c8060341b8217915083811c935050828302607f1c92508260801c8060331b8217915083811c935050828302607f1c92508260801c8060321b8217915050600081693627a301d71055774c856146419190615146565b9050600060806146616f028f6481ab7f045a5af012a19d003aaa84615107565b901d905060006080614683846fdb2df09e81959a81455e260799a0632f6151cd565b901d90508060020b8260020b146146c257886001600160a01b03166146a782613afc565b6001600160a01b031611156146bc57816146c4565b806146c4565b815b9998505050505050505050565b6000836001600160a01b0316856001600160a01b031611156146f1579293925b846001600160a01b0316866001600160a01b03161161471c57614715858585613ea3565b90506134fb565b836001600160a01b0316866001600160a01b0316101561477e576000614743878686613ea3565b90506000614752878986613e52565b9050806001600160801b0316826001600160801b0316106147735780614775565b815b925050506134fb565b6142c9858584613e52565b6060613e9b8484600085614897565b606083156147a757508161124a565b8251156147b75782518084602001fd5b8160405162461bcd60e51b81526004016112aa9190614a02565b6000826001600160a01b0316846001600160a01b031611156147f1579192915b6001600160a01b0384166148437bffffffffffffffffffffffffffffffff000000000000000000000000606085901b1661482b87876150ad565b6001600160a01b0316866001600160a01b03166122df565b613e9b9190614e89565b6000826001600160a01b0316846001600160a01b0316111561486d579192915b613e9b6001600160801b03831661488486866150ad565b6001600160a01b0316600160601b6122df565b60608247101561490f5760405162461bcd60e51b815260206004820152602660248201527f416464726573733a20696e73756666696369656e742062616c616e636520666f60448201527f722063616c6c000000000000000000000000000000000000000000000000000060648201526084016112aa565b843b61495d5760405162461bcd60e51b815260206004820152601d60248201527f416464726573733a2063616c6c20746f206e6f6e2d636f6e747261637400000060448201526064016112aa565b600080866001600160a01b0316858760405161497991906150eb565b60006040518083038185875af1925050503d80600081146149b6576040519150601f19603f3d011682016040523d82523d6000602084013e6149bb565b606091505b50915091506149cb828286614798565b979650505050505050565b60005b838110156149f15781810151838201526020016149d9565b83811115611e785750506000910152565b6020815260008251806020840152614a218160408501602087016149d6565b601f01601f19169190910160400192915050565b6001600160a01b0381168114614a4a57600080fd5b50565b60008060408385031215614a6057600080fd5b8235614a6b81614a35565b946020939093013593505050565b600060208284031215614a8b57600080fd5b813561124a81614a35565b600080600060608486031215614aab57600080fd5b8335614ab681614a35565b92506020840135614ac681614a35565b929592945050506040919091013590565b60008060008060808587031215614aed57600080fd5b5050823594602084013594506040840135936060013592509050565b600080600060608486031215614b1e57600080fd5b505081359360208301359350604090920135919050565b60008060008060608587031215614b4b57600080fd5b8435935060208501359250604085013567ffffffffffffffff80821115614b7157600080fd5b818701915087601f830112614b8557600080fd5b813581811115614b9457600080fd5b886020828501011115614ba657600080fd5b95989497505060200194505050565b60ff81168114614a4a57600080fd5b600080600080600080600060e0888a031215614bdf57600080fd5b8735614bea81614a35565b96506020880135614bfa81614a35565b955060408801359450606088013593506080880135614c1881614bb5565b9699959850939692959460a0840135945060c09093013592915050565b60008060408385031215614c4857600080fd5b8235614c5381614a35565b91506020830135614c6381614a35565b809150509250929050565b600181811c90821680614c8257607f821691505b602082108103614ca257634e487b7160e01b600052602260045260246000fd5b50919050565b805161ffff8116811461438557600080fd5b8051801515811461438557600080fd5b600080600080600080600060e0888a031215614ce557600080fd5b8751614cf081614a35565b8097505060208801518060020b8114614d0857600080fd5b9550614d1660408901614ca8565b9450614d2460608901614ca8565b9350614d3260808901614ca8565b925060a0880151614d4281614bb5565b9150614d5060c08901614cba565b905092959891949750929550565b634e487b7160e01b600052601160045260246000fd5b60008219821115614d8757614d87614d5e565b500190565b60008160020b8360020b6000811281627fffff1901831281151615614db357614db3614d5e565b81627fffff018313811615614dca57614dca614d5e565b5090039392505050565b600082821015614de657614de6614d5e565b500390565b60008160020b8360020b6000821282627fffff03821381151615614e1157614e11614d5e565b82627fffff19038212811615614e2957614e29614d5e565b50019392505050565b600063ffffffff808316818516808303821115614e5157614e51614d5e565b01949350505050565b600060208284031215614e6c57600080fd5b5051919050565b634e487b7160e01b600052601260045260246000fd5b600082614e9857614e98614e73565b500490565b60008260020b80614eb057614eb0614e73565b808360020b0791505092915050565b60008060408385031215614ed257600080fd5b505080516020909101519092909150565b80516001600160801b038116811461438557600080fd5b60008060408385031215614f0d57600080fd5b614f1683614ee3565b9150614f2460208401614ee3565b90509250929050565b6000816000190483118215151615614f4757614f47614d5e565b500290565b600060208284031215614f5e57600080fd5b61124a82614cba565b634e487b7160e01b600052600160045260246000fd5b600080835481600182811c915080831680614f9957607f831692505b60208084108203614fb857634e487b7160e01b86526022600452602486fd5b818015614fcc5760018114614fdd5761500a565b60ff1986168952848901965061500a565b60008a81526020902060005b868110156150025781548b820152908501908301614fe9565b505084890196505b509498975050505050505050565b600080600080600060a0868803121561503057600080fd5b61503986614ee3565b9450602086015193506040860151925061505560608701614ee3565b915061506360808701614ee3565b90509295509295909350565b6000600160ff1b820161508457615084614d5e565b5060000390565b60008160020b627fffff1981036150a4576150a4614d5e565b60000392915050565b60006001600160a01b03838116908316818110156150cd576150cd614d5e565b039392505050565b634e487b7160e01b600052603260045260246000fd5b600082516150fd8184602087016149d6565b9190910192915050565b60008083128015600160ff1b85018412161561512557615125614d5e565b836001600160ff1b0301831381161561514057615140614d5e565b50500390565b60006001600160ff1b0360008413600084138583048511828216161561516e5761516e614d5e565b600160ff1b600087128281168783058912161561518d5761518d614d5e565b600087129250878205871284841616156151a9576151a9614d5e565b878505871281841616156151bf576151bf614d5e565b505050929093029392505050565b6000808212826001600160ff1b03038413811516156151ee576151ee614d5e565b600160ff1b839003841281161561520757615207614d5e565b5050019056fe416464726573733a206c6f772d6c6576656c2064656c65676174652063616c6c206661696c6564a2646970667358221220ab8d9d29c5b882871b9dc6d4037b9157acd852612239097afe82b5fe20ab9fdb64736f6c634300080d0033";

    Factory factory;

    function setUp() public {
        factory = new Factory(IVolatilityOracle(address(1)), CREATION_CODE);
    }

    function test_creationCode() public {
        assertEq(CREATION_CODE.length, type(AloeBlend).creationCode.length);
        assertEq(keccak256(CREATION_CODE), keccak256(type(AloeBlend).creationCode));
    }

    function test_createVault() public {
        IAloeBlend blend = factory.createVault(
            IUniswapV3Pool(0xF1B63cD9d80f922514c04b0fD0a30373316dd75b),
            ISilo(0x8E35ec3f2C8e14bf7A0E67eA6667F6965938aD2d),
            ISilo(0x908f6DF3df3c25365172F350670d055541Ec362E)
        );

        assertEq(address(blend.silo0()), 0x8E35ec3f2C8e14bf7A0E67eA6667F6965938aD2d);
        assertEq(address(blend.silo1()), 0x908f6DF3df3c25365172F350670d055541Ec362E);
        assertEq(blend.getRebalanceUrgency(), 0);
    }

    function testFail_createSameVaultTwice() public {
        factory.createVault(
            IUniswapV3Pool(0xF1B63cD9d80f922514c04b0fD0a30373316dd75b),
            ISilo(0x8E35ec3f2C8e14bf7A0E67eA6667F6965938aD2d),
            ISilo(0x908f6DF3df3c25365172F350670d055541Ec362E)
        );
        factory.createVault(
            IUniswapV3Pool(0xF1B63cD9d80f922514c04b0fD0a30373316dd75b),
            ISilo(0x8E35ec3f2C8e14bf7A0E67eA6667F6965938aD2d),
            ISilo(0x908f6DF3df3c25365172F350670d055541Ec362E)
        );
    }
}
